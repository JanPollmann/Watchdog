plugins {
    id 'watchdog.library-conventions'
    id 'watchdog.publication-conventions'
}

if (project.findProperty("gpr.user") && project.findProperty("gpr.key")) {
    println "publishing to GitHubPackages enabled with following credentials:"
    println project.findProperty("gpr.user") ?: System.getenv("USERNAME")
    println project.findProperty("gpr.key") ?: System.getenv("TOKEN")

    publishing {
        publications {
            gpr(MavenPublication) {
                groupId = 'de.pollmann.Watchdog'
                artifactId = 'Watchdog'
                version = '0.0.2'

                from components.java

                pom {
                    name = 'Watchdog'
                    description = 'A function call watchdog for java'

                    licenses {
                        license {
                            name = 'The Unlicense'
                            url = 'https://unlicense.org'
                        }
                    }
                }
            }
        }

        repositories {
            maven {
                name = "GitHubPackages"
                url = uri("https://maven.pkg.github.com/JanPollmann/Watchdog")
                credentials {
                    username = project.findProperty("gpr.user") ?: System.getenv("USERNAME")
                    password = project.findProperty("gpr.key") ?: System.getenv("TOKEN")
                }
            }
        }
    }
}

dependencies {

}
