plugins {
    id 'watchdog.library-conventions'
    id 'watchdog.publication-conventions'
}

def user = project.findProperty("gpr.user") ?: System.getenv("USERNAME")
def key = project.findProperty("gpr.key") ?: System.getenv("TOKEN")

if (user != null && key != null) {
    println "publishing to GitHubPackages enabled with following credentials:"
    println user
    println key

    publishing {
        publications {
            gpr(MavenPublication) {
                groupId = 'de.pollmann.Watchdog'
                artifactId = 'Watchdog'
                version = '0.0.1-alpha1'

                from components.java

                pom {
                    name = 'Watchdog'
                    description = 'A function call watchdog for java'

                    licenses {
                        license {
                            name = 'The Unlicense'
                            url = 'https://unlicense.org'
                        }
                    }
                }
            }
        }

        repositories {
            maven {
                name = "GitHubPackages"
                url = uri("https://maven.pkg.github.com/JanPollmann/Watchdog")
                credentials {
                    username = user
                    password = key
                }
            }
        }
    }
}

dependencies {

}
